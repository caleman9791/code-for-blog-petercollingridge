<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" data-darkreader-mode="dynamic" data-darkreader-scheme="dark" scrolltop="NaN" data-lt-installed="true">
	<!-- <![endif]-->
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<style class="darkreader darkreader--fallback" media="screen">
		</style>
		<style class="darkreader darkreader--text" media="screen">
		</style>
		<style class="darkreader darkreader--invert" media="screen">
				.jfk-bubble.gtx-bubble, .captcheck_answer_label>
				input + img, span#closed_text>
				img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"]>
				#icon, #bit-notification-bar-iframe, ::-webkit-calendar-picker-indicator {
				filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
				}
		</style>
		<style class="darkreader darkreader--inline" media="screen">
				[data-darkreader-inline-bgcolor] {
				background-color: var(--darkreader-inline-bgcolor) !important;
				}
				[data-darkreader-inline-bgimage] {
				background-image: var(--darkreader-inline-bgimage) !important;
				}
				[data-darkreader-inline-border] {
				border-color: var(--darkreader-inline-border) !important;
				}
				[data-darkreader-inline-border-bottom] {
				border-bottom-color: var(--darkreader-inline-border-bottom) !important;
				}
				[data-darkreader-inline-border-left] {
				border-left-color: var(--darkreader-inline-border-left) !important;
				}
				[data-darkreader-inline-border-right] {
				border-right-color: var(--darkreader-inline-border-right) !important;
				}
				[data-darkreader-inline-border-top] {
				border-top-color: var(--darkreader-inline-border-top) !important;
				}
				[data-darkreader-inline-boxshadow] {
				box-shadow: var(--darkreader-inline-boxshadow) !important;
				}
				[data-darkreader-inline-color] {
				color: var(--darkreader-inline-color) !important;
				}
				[data-darkreader-inline-fill] {
				fill: var(--darkreader-inline-fill) !important;
				}
				[data-darkreader-inline-stroke] {
				stroke: var(--darkreader-inline-stroke) !important;
				}
				[data-darkreader-inline-outline] {
				outline-color: var(--darkreader-inline-outline) !important;
				}
				[data-darkreader-inline-stopcolor] {
				stop-color: var(--darkreader-inline-stopcolor) !important;
				}
		</style>
		<style class="darkreader darkreader--variables" media="screen">
				:root {
				--darkreader-neutral-background: #131516;
				--darkreader-neutral-text: #d8d4cf;
				--darkreader-selection-background: #004daa;
				--darkreader-selection-text: #e8e6e3;
				}
		</style>
		<style class="darkreader darkreader--root-vars" media="screen">
		</style>
		<style class="darkreader darkreader--user-agent" media="screen">
				html {
				background-color: #181a1b !important;
				}
				html {
				color-scheme: dark !important;
				}
				html, body {
				background-color: #181a1b;
				}
				html, body {
				border-color: #736b5e;
				color: #e8e6e3;
				}
				a {
				color: #3391ff;
				}
				table {
				border-color: #545b5e;
				}
				::placeholder {
				color: #b2aba1;
				}
				input:-webkit-autofill,
				textarea:-webkit-autofill,
				select:-webkit-autofill {
				background-color: #404400 !important;
				color: #e8e6e3 !important;
				}
				::-webkit-scrollbar {
				background-color: #202324;
				color: #aba499;
				}
				::-webkit-scrollbar-thumb {
				background-color: #454a4d;
				}
				::-webkit-scrollbar-thumb:hover {
				background-color: #575e62;
				}
				::-webkit-scrollbar-thumb:active {
				background-color: #484e51;
				}
				::-webkit-scrollbar-corner {
				background-color: #181a1b;
				}
				* {
				scrollbar-color: #454a4d #202324;
				}
				::selection {
				background-color: #004daa !important;
				color: #e8e6e3 !important;
				}
				::-moz-selection {
				background-color: #004daa !important;
							color: #e8e6e3 !important;
							}
					</style>
		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
		<meta name="author" content="Peter Collingridge"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<title>
			Draggable SVG elements
		</title>
		<meta property="og:site_name" content="petercollingridge.co.uk"/>
		<meta property="og:type" content="website"/>
		<meta property="og:url" content="http://petercollingridge.co.uk/tutorials/svg/interactive/dragging/"/>
		<meta property="og:title" content="Draggable SVG elements"/>
		<meta name="description" content="A step-by-step guide to making SVG elements draggable."/>
		<meta property="og:description" content="A step-by-step guide to making SVG elements draggable."/>
		<meta property="og:image" content="http://petercollingridge.co.ukhttps://media.petercollingridge.co.uk/images/Screen_Shot_2019-01-06_at_21.39.50.width-400.png"/>
		<meta property="og:image:width" content="400"/>
		<meta property="og:image:height" content="267"/>
		<link rel="stylesheet" href="Draggable%20SVG%20elements_files/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous"/>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<link rel="stylesheet" href="Draggable%20SVG%20elements_files/font-awesome.min.bf0c425cdb73.css"/>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<link rel="stylesheet" type="text/css" href="Draggable%20SVG%20elements_files/base.5b0ea2f049b9.css"/>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<link href="Draggable%20SVG%20elements_files/css.css" rel="stylesheet" type="text/css"/>
		<link rel="shortcut icon" href="https://wagtail.petercollingridge.co.uk/favicon.ico"/>
		<link rel="stylesheet" type="text/css" href="Draggable%20SVG%20elements_files/ajaxcomments.css"/>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<meta name="darkreader" content="c7ce42e66fa243e0a8b3ae6087e91c8d"/>
		<style class="darkreader darkreader--override" media="screen">
				.vimvixen-hint {
				background-color: #7b5300 !important;
				border-color: #d8b013 !important;
				color: #f3e8c8 !important;
				}
				#vimvixen-console-frame {
				color-scheme: light !important
				}
				::placeholder {
				opacity: 0.5 !important;
				}
				#edge-translate-panel-body,
				.MuiTypography-body1,
				.nfe-quote-text {
				color: var(--darkreader-neutral-text) !important;
				}
				gr-main-header {
				background-color: #0f3a48 !important;
				}
				.tou-z65h9k,
				.tou-mignzq,
				.tou-1b6i2ox,
				.tou-lnqlqk {
				background-color: var(--darkreader-neutral-background) !important;
				}
				.tou-75mvi {
				background-color: #032029 !important;
				}
				.tou-ta9e87,
				.tou-1w3fhi0,
				.tou-1b8t2us,
				.tou-py7lfi,
				.tou-1lpmd9d,
				.tou-1frrtv8,
				.tou-17ezmgn {
				background-color: #0a0a0a !important;
				}
				.tou-uknfeu {
				background-color: #231603 !important;
				}
				.tou-6i3zyv {
				background-color: #19576c !important;
				}
				div.mermaid-viewer-control-panel .btn {
				fill: var(--darkreader-neutral-text);
				background-color: var(--darkreader-neutral-background);
				}
				svg g rect.er {
				fill: var(--darkreader-neutral-background) !important;
				}
				svg g rect.er.entityBox {
				fill: var(--darkreader-neutral-background) !important;
				}
				svg g rect.er.attributeBoxOdd {
				fill: var(--darkreader-neutral-background) !important;
				}
				svg g rect.er.attributeBoxEven {
				fill-opacity: 0.8 !important;
				fill: var(--darkreader-selection-background);
				}
				svg rect.er.relationshipLabelBox {
				fill: var(--darkreader-neutral-background) !important;
				}
				svg g g.nodes rect, svg g g.nodes polygon {
				fill: var(--darkreader-neutral-background) !important;
				}
				svg g rect.task {
				fill: var(--darkreader-selection-background) !important;
				}
				svg line.messageLine0, svg line.messageLine1 {
				stroke: var(--darkreader-neutral-text) !important;
				}
				div.mermaid .actor {
				fill: var(--darkreader-neutral-background) !important;
				}
				embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }
		</style>
		<link rel="stylesheet" type="text/css" href="Draggable%20SVG%20elements_files/prettify.css"/>
		<style class="darkreader darkreader--cors" media="screen">
				.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.clo,.opn,.pun{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.kwd,.tag,.typ{font-weight:700}.str{color:#060}.kwd{color:#006}.com{color:#600;font-style:italic}.typ{color:#404}.lit{color:#044}.clo,.opn,.pun{color:#440}.tag{color:#006}.atn{color:#404}.atv{color:#060}}pre.prettyprint{padding:2px;border:1px solid #888}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<script type="text/javascript" async="" src="Draggable%20SVG%20elements_files/ga.js">
		</script>
		<style type="text/css">
				.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
				.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
				.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
				.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
				.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
				#MathJax_About.MathJax_MousePost {outline: none}
				.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
				.MathJax_MenuItem {padding: 1px 2em; background: transparent}
				.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
				.MathJax_MenuActive .MathJax_MenuArrow {color: white}
				.MathJax_MenuArrow.RTL {left: .5em; right: auto}
				.MathJax_MenuCheck {position: absolute; left: .7em}
				.MathJax_MenuCheck.RTL {right: .7em; left: auto}
				.MathJax_MenuRadioCheck {position: absolute; left: .7em}
				.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
				.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
				.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
				.MathJax_MenuDisabled {color: GrayText}
				.MathJax_MenuActive {background-color: #606872; color: white}
				.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
				.MathJax_ContextMenu:focus {outline: none}
				.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
				#MathJax_AboutClose {top: .2em; right: .2em}
				.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
				.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
				.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
				.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
				.MathJax_MenuClose:hover span {background-color: #CCC!important}
				.MathJax_MenuClose:hover:focus {outline: none}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				.MathJax_Preview .MJXf-math {color: inherit!important}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
				.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
				#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
				#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
				#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				.MathJax_Preview {color: #888}
				#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
				#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
				.MathJax_Error {color: #CC0000; font-style: italic}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				.MJXp-script {font-size: .8em}
				.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
				.MJXp-bold {font-weight: bold}
				.MJXp-italic {font-style: italic}
				.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
				.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
				.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
				.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
				.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
				.MJXp-largeop {font-size: 150%}
				.MJXp-largeop.MJXp-int {vertical-align: -.2em}
				.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
				.MJXp-display {display: block; text-align: center; margin: 1em 0}
				.MJXp-math span {display: inline-block}
				.MJXp-box {display: block!important; text-align: center}
				.MJXp-box:after {content: " "}
				.MJXp-rule {display: block!important; margin-top: .1em}
				.MJXp-char {display: block!important}
				.MJXp-mo {margin: 0 .15em}
				.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
				.MJXp-denom {display: inline-table!important; width: 100%}
				.MJXp-denom>
				* {display: table-row!important}
				.MJXp-surd {vertical-align: top}
				.MJXp-surd>
				* {display: block!important}
				.MJXp-script-box>
				*  {display: table!important; height: 50%}
				.MJXp-script-box>
				*>
				* {display: table-cell!important; vertical-align: top}
				.MJXp-script-box>
				*:last-child>
				* {vertical-align: bottom}
				.MJXp-script-box>
				*>
				*>
				* {display: block!important}
				.MJXp-mphantom {visibility: hidden}
				.MJXp-munderover {display: inline-table!important}
				.MJXp-over {display: inline-block!important; text-align: center}
				.MJXp-over>
				* {display: block!important}
				.MJXp-munderover>
				* {display: table-row!important}
				.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
				.MJXp-mtable>
				* {display: inline-table!important; vertical-align: middle}
				.MJXp-mtr {display: table-row!important}
				.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
				.MJXp-mtr>
				.MJXp-mtd:first-child {padding-left: 0}
				.MJXp-mtr:first-child>
				.MJXp-mtd {padding-top: 0}
				.MJXp-mlabeledtr {display: table-row!important}
				.MJXp-mlabeledtr>
				.MJXp-mtd:first-child {padding-left: 0}
				.MJXp-mlabeledtr:first-child>
				.MJXp-mtd {padding-top: 0}
				.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
				.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
				.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
				.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
				.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
				.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
				.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
				.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
				.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
				.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
				.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
				.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
		<style type="text/css">
				.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
				.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
				.MathJax .MJX-monospace {font-family: monospace}
				.MathJax .MJX-sans-serif {font-family: sans-serif}
				#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
				.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
				.MathJax:focus, body :focus .MathJax {display: inline-table}
				.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
				.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
				img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
				.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
				.MathJax nobr {white-space: nowrap!important}
				.MathJax img {display: inline!important; float: none!important}
				.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
				.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
				.MathJax_Processed {display: none!important}
				.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
				.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
				.MathJax_LineBox {display: table!important}
				.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
				.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
				.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
				#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
				@font-face {font-family: MathJax_Blank; src: url('about:blank')}
				.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
		</style>
		<style class="darkreader darkreader--sync" media="screen">
		</style>
	</head>
	<body class="article-body" scrolltop="NaN" cz-shortcut-listen="true">
		<div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; --darkreader-inline-border-top: currentcolor; --darkreader-inline-border-right: currentcolor; --darkreader-inline-border-bottom: currentcolor; --darkreader-inline-border-left: currentcolor;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div id="MathJax_Hidden">
			</div>
		</div>
		<div id="MathJax_Message" style="display: none;">
		</div>
		<div id="body">
			<nav class="navbar navbar-expand-md navbar-dark fixed-top">
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon">
					</span>
				</button>
				<div class="collapse navbar-collapse" id="navbarsExampleDefault">
					<ul class="navbar-nav mr-auto">
						<li class="nav-item active">
							<a class="nav-link" href="https://www.petercollingridge.co.uk/">
								<i class="navbar-brand fa fa-home">
								</i>
								<span class="sr-only">
									(current)
								</span>
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://www.petercollingridge.co.uk/tutorials">
								Tutorials
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://www.petercollingridge.co.uk/blog">
								Articles
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://www.petercollingridge.co.uk/tools">
								Tools
							</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="https://www.petercollingridge.co.uk/about">
								About
							</a>
						</li>
					</ul>
					<form class="form-inline my-2 my-lg-0" action="/search/" method="get">
						<input class="form-control mr-sm-2" type="text" name="query" placeholder="Search" aria-label="Search"/>
						<button class="btn btn-outline my-2 my-sm-0" type="submit">
							Search
						</button>
					</form>
				</div>
			</nav>
			<main role="main" class="container">
				<h1>
					Draggable SVG elements
				</h1>
				<div class="content">
					<div class="row">
						<div class="col-4">
							<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/tooltip/">
								<span class="naviagation-arrow">
									<i class="fa fa-caret-left" aria-hidden="true">
									</i>
								</span>
								<span class="navigation-name">
									Tooltip
								</span>
							</a>
						</div>
						<div class="col-4 parent-page-link">
							<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/">
								Interactive SVGs
							</a>
						</div>
						<div class="col-4 next-page-link">
							<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/pan-and-zoom/">
								<span class="navigation-name">
									Panning and zooming
								</span>
								<span class="naviagation-arrow">
									<i class="fa fa-caret-right" aria-hidden="true">
									</i>
								</span>
							</a>
						</div>
					</div>
					<hr/>
					<div class="info-header">
						<span class="date">
							3 Apr 2018
						</span>
						<span class="github-link">
							<a href="https://github.com/petercollingridge/code-for-blog/tree/master/svg-interaction/draggable" target="_blank">
								<i class="fa fa-github">
								</i>
								<span>
									Code on Github
								</span>
							</a>
						</span>
					</div>
					<article>
						<h2>
							Introduction
						</h2>
						<section class="section-block block-paragraph">
							<div class="rich-text">
								<p>
									[This is a completely rewritten version of a post from 1st September 2011]
								</p>
								<p>
									One
									of the most common forms of interaction on a computer is clicking and
									dragging. I use it a lot for interactive demos, such as those in my
									<a href="https://www.petercollingridge.co.uk/tutorials/svg/basics/">
										SVG tutorial
									</a>
									, and have a built
									<a href="https://www.petercollingridge.co.uk/tools/interactivesvgjs/">
										a library
									</a>
									for making simple draggable SVG diagrams.
								</p>
								<p>
									You can find the code for all the examples on this page
									<a href="https://github.com/petercollingridge/code-for-blog/tree/master/svg-interaction/draggable">
										here
									</a>
									.
									This article builds up the code required step-by-step, explaining why
									each element is needed. If you only care about finished code, you can
									find it
									<a href="https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_6.svg">
										here
									</a>
									.
								</p>
							</div>
						</section>
						<div class="row">
							<div class="col-md-7 two-col-block left-block">
								<section class="section-block block-paragraph">
									<div class="rich-text">
										<p>
											This is the SVG I'm going to
											build on this page. It's relatively simple, but it demonstrates the code
											works with different element types. Some of the elements have
											transformations applied to them. For example, the star is rotated. There
											is also a static rect element which can't be dragged.
										</p>
									</div>
								</section>
							</div>
							<div class="col-md-5 two-col-block right-block">
								<section class="section-block block-html">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable(evt)">
										<style>
													.background {
														fill: #eee;
													}
													.static {
														cursor: not-allowed;
													}
													.draggable {
														cursor: move;
													}
												</style>
										<style class="darkreader darkreader--sync" media="screen">
										</style>
										<script type="text/javascript">
													function makeDraggable(evt) {
														var svg = evt.target;
														svg.addEventListener('mousedown', startDrag, false);
														svg.addEventListener('mousemove', drag, false);
														svg.addEventListener('mouseup', endDrag, false);
														svg.addEventListener('mouseleave', endDrag);
										
														function getMousePosition(evt) {
															var CTM = svg.getScreenCTM();
															return {
																x: (evt.clientX - CTM.e) / CTM.a,
																y: (evt.clientY - CTM.f) / CTM.d
															};
														}
										
														var selectedElement, offset, transform;
										
														function startDrag(evt) {
															if (evt.target.classList.contains('draggable')) {
																selectedElement = evt.target;
																offset = getMousePosition(evt);
										
																// Make sure the first transform on the element is a translate transform
																var transforms = selectedElement.transform.baseVal;
										
																if (transforms.length === 0 || transforms.getItem(0).type !== SVGTransform.SVG_TRANSFORM_TRANSLATE) {
																	// Create an transform that translates by (0, 0)
																	var translate = svg.createSVGTransform();
																	translate.setTranslate(0, 0);
																	selectedElement.transform.baseVal.insertItemBefore(translate, 0);
																}
										
																// Get initial translation
																transform = transforms.getItem(0);
																offset.x -= transform.matrix.e;
																offset.y -= transform.matrix.f;
															}
														}
										
														function drag(evt) {
															if (selectedElement) {
																evt.preventDefault();
																var coord = getMousePosition(evt);
																transform.setTranslate(coord.x - offset.x, coord.y - offset.y);
															}
														}
										
														function endDrag(evt) {
															selectedElement = false;
														}
													}
												 </script>
										<rect class="background" x="0" y="0" width="30" height="20">
										</rect>
										<rect class="static" fill="#888" x="2" y="4" width="6" height="2" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill="">
										</rect>
										<rect class="draggable" fill="#007bff" x="2" y="4" width="6" height="2" transform="rotate(90, 5, 5) translate(10, 0)" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill="">
										</rect>
										<ellipse class="draggable" fill="#ff00af" cx="5" cy="5" rx="3" ry="2" transform="translate(10, 0)" style="--darkreader-inline-fill: #cc008c;" data-darkreader-inline-fill="">
										</ellipse>
										<polygon class="draggable" fill="#ffa500" transform="rotate(15, 15, 15)" points="16.9 15.6 17.4 18.2 15 17 12.6 18.2 13.1 15.6 11.2 13.8 13.8 13.4 15 11 16.2 13.4 18.8 13.8" style="--darkreader-inline-fill: #cc8400;" data-darkreader-inline-fill="">
										</polygon>
										<path class="draggable" stroke="#2bad7b" stroke-width="0.5" fill="none" d="M1 5C5 1 5 9 9 5" transform="translate(20)" style="--darkreader-inline-stroke: #5dd7a8;" data-darkreader-inline-stroke="">
										</path>
										<text class="draggable" x="25" y="15" text-anchor="middle" font-size="3px" alignment-baseline="middle" transform="translate(-4.08197, -1.4934)">
											Drag
										</text>
									</svg>
								</section>
							</div>
						</div>
						<h2>
							SVG setup
						</h2>
						<section class="section-block block-paragraph">
							<div class="rich-text">
								<p>
									Let's start with a simple SVG with two
									<b>
										rect
									</b>
									element, one we want to be draggable and another we don't.
								</p>
							</div>
						</section>
						<div class="row">
							<div class="col-md-7 two-col-block left-block">
								<pre class="prettyprint linenums prettyprinted" style="">
									<ol class="linenums">
										<li class="L0">
											<code class="language-XML">
												<span class="tag">
													&lt;svg
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													xmlns
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"http://www.w3.org/2000/svg"
												</span>
											</code>
										</li>
										<li class="L1">
											<code class="language-XML">
												<span class="atn">
													viewBox
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"0 0 30 20"
												</span>
												<span class="tag">
													&gt;
												</span>
											</code>
										</li>
										<li class="L2">
											<code class="language-XML">
												<span class="pln">
												</span>
												<span class="tag">
													&lt;rect
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													x
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"0"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													y
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"0"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													width
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"30"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													height
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"20"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													fill
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"#fafafa"
												</span>
												<span class="tag">
													/&gt;
												</span>
											</code>
										</li>
										<li class="L3">
											<code class="language-XML">
												<span class="pln">
												</span>
												<span class="tag">
													&lt;rect
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													x
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"4"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													y
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"5"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													width
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"8"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													height
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"10"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													fill
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"#007bff"
												</span>
												<span class="tag">
													/&gt;
												</span>
											</code>
										</li>
										<li class="L4">
											<code class="language-XML">
												<span class="pln">
												</span>
												<span class="tag">
													&lt;rect
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													x
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"18"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													y
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"5"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													width
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"8"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													height
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"10"
												</span>
												<span class="pln">
												</span>
												<span class="atn">
													fill
												</span>
												<span class="pun">
													=
												</span>
												<span class="atv">
													"#888"
												</span>
												<span class="tag">
													/&gt;
												</span>
											</code>
										</li>
										<li class="L5">
											<code class="language-XML">
												<span class="tag">
													&lt;/svg&gt;
												</span>
											</code>
										</li>
									</ol>
								</pre>
							</div>
							<div class="col-md-5 two-col-block right-block">
								<section class="section-block block-html">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20">
										<rect x="0" y="0" width="30" height="20" class="background">
										</rect>
										<rect x="4" y="5" width="8" height="10" fill="#007bff" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill="">
										</rect>
										<rect x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill="">
										</rect>
									</svg>
								</section>
							</div>
						</div>
						<h2>
							CSS
						</h2>
						<section class="section-block block-paragraph">
							<div class="rich-text">
								<p>
									First give the
									<b>
										rect
									</b>
									we want to make draggable the class "draggable". We can give the other
									<b>
										rect
									</b>
									the class static. We can then give the user an idea about what they can
									interactive with by changing the cursor when they mouseover each
									element
								</p>
							</div>
						</section>
						<div class="row">
							<div class="col-md-7 two-col-block left-block">
								<pre class="prettyprint linenums:8 prettyprinted" style="">
									<ol class="linenums">
										<li value="8" class="L7">
											<code class="language-CSS">
												<span class="pun">
													.
												</span>
												<span class="kwd">
													static
												</span>
												<span class="pln">
												</span>
												<span class="pun">
													{
												</span>
											</code>
										</li>
										<li class="L8">
											<code class="language-CSS">
												<span class="pln">
													cursor
												</span>
												<span class="pun">
													:
												</span>
												<span class="pln">
												</span>
												<span class="kwd">
													not
												</span>
												<span class="pun">
													-
												</span>
												<span class="pln">
													allowed
												</span>
												<span class="pun">
													;
												</span>
											</code>
										</li>
										<li class="L9">
											<code class="language-CSS">
												<span class="pun">
													}
												</span>
											</code>
										</li>
										<li class="L0">
											<code class="language-CSS">
												<span class="pun">
													.
												</span>
												<span class="pln">
													draggable
												</span>
												<span class="pun">
													{
												</span>
											</code>
										</li>
										<li class="L1">
											<code class="language-CSS">
												<span class="pln">
													cursor
												</span>
												<span class="pun">
													:
												</span>
												<span class="pln">
													move
												</span>
												<span class="pun">
													;
												</span>
											</code>
										</li>
										<li class="L2">
											<code class="language-CSS">
												<span class="pun">
													}
												</span>
											</code>
										</li>
									</ol>
								</pre>
							</div>
							<div class="col-md-5 two-col-block right-block">
								<section class="section-block block-html">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20">
										<rect x="0" y="0" width="30" height="20" class="background">
										</rect>
										<rect class="draggable" x="4" y="5" width="8" height="10" fill="#007bff" "="" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <rect class="static" x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> </svg> </section> </div> </div> <h2> Javascript outline    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> The click-and-drag interaction has two obvious parts: click and drag, but really there are three:    </p> <ul> <li> <b> Pressing the mouse    </b> , when we need to find what element, if any, we have pressed on.    </li> <li> <b> Dragging the mouse    </b> , when we need to move the element.    </li> <li> <b> Releasing the mouse    </b> , when we need to release the element so it doesn't continue to move when we move the mouse.    </li> </ul> <p> This is fairly straightforward but there a bit of subtlety required to get it right.    </p> <p> Let's start by making a     <b> makeDraggable    </b> function. This can be in a separate Javascript file or in a script  element inside the SVG itself. We call this function when the to the SVG element loads, passing in the load event:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums prettyprinted" style=""> <ol class="linenums"> <li class="L0"> <code class="language-XML"> <span class="tag"> &lt;svg    </span> <span class="pln"> </span> <span class="atn"> xmlns    </span> <span class="pun"> =    </span> <span class="atv"> "http://www.w3.org/2000/svg"    </span> </code> </li> <li class="L1"> <code class="language-XML"> <span class="pln"> </span> <span class="atn"> viewBox    </span> <span class="pun"> =    </span> <span class="atv"> "0 0 30 20"    </span> </code> </li> <li class="L2"> <code class="language-XML"> <span class="pln"> </span> <span class="atn"> onload    </span> <span class="pun"> =    </span> <span class="atv"> "    </span>
											<span class="pln">
												makeDraggable
											</span>
											<span class="pun">
												(
											</span>
											<span class="pln">
												evt
											</span>
											<span class="pun">
												)
											</span>
											<span class="atv">
												"    </span> <span class="tag"> &gt;    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> This function itself gets the SVG element as the event target and binds event listeners to     <b> mousedown    </b> ,     <b> mousemove    </b> ,    <b> mouseup    </b> , and     <b> mouseleave    </b> events on the SVG element.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums prettyprinted" style=""> <ol class="linenums"> <li class="L0"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> makeDraggable    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> svg     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> ;    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'mousedown'    </span> <span class="pun"> ,    </span> <span class="pln"> startDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'mousemove'    </span> <span class="pun"> ,    </span> <span class="pln"> drag    </span> <span class="pun"> );    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'mouseup'    </span> <span class="pun"> ,    </span> <span class="pln"> endDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'mouseleave'    </span> <span class="pun"> ,    </span> <span class="pln"> endDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L6"> <code class="language-javascript"> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> function    </span> <span class="pln"> startDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L9"> <code class="language-javascript"> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L2"> <code class="language-javascript"> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> function    </span> <span class="pln"> endDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <h2> Selecting an element    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Let's test that we can select and deselect an element. First create a variable     <b> selectedElement    </b> and set it to     <b> null    </b> (or something falsy). We add it outside of the dragging function so they can all refer to it, but inside     <b> makeDraggable    </b> so it's not global.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:7 prettyprinted" style=""> <ol class="linenums"> <li value="7" class="L6"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="kwd"> false    </span> <span class="pun"> ;    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Our     <b> startDrag    </b> function should test whether the target of the mousedown event it's passed has the class     <b> draggable    </b> , and if so set     <b> selectedElement    </b> to that element.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:9 prettyprinted" style=""> <ol class="linenums"> <li value="9" class="L8"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> startDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> .    </span> <span class="pln"> classList    </span> <span class="pun"> .    </span> <span class="pln"> contains    </span> <span class="pun"> (    </span> <span class="str"> 'draggable'    </span> <span class="pun"> ))    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> ;    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> For now, we'll just make the     <b> drag    </b> function increment the     <b> x    </b> attribute of the selected element. Note that we use     <b> getAttributeNS    </b> and     <b> setAttributeNS    </b> when use SVG elements. We also have to make sure we convert the attribute into a float before we add 0.1 to it.    </p> <p> I've also add     <b> evt.preventDefault();    </b> which blocks any other dragging behaviour. For example, in the SVG at  the top of the page, if you drag an element over the text element, it  won't highlight the text.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:15 prettyprinted" style=""> <ol class="linenums"> <li value="15" class="L4"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> preventDefault    </span> <span class="pun"> ();    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> x     </span> <span class="pun"> =    </span> <span class="pln"> parseFloat    </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> getAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ));    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ,    </span> <span class="pln"> x     </span> <span class="pun"> +    </span> <span class="pln"> </span> <span class="lit"> 0.1    </span> <span class="pun"> );    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> The     <b> endDrag    </b> function just needs to set     <b> selectedElement    </b> back to     <b> null    </b> , so we don't keep moving it once the mouse has been released.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:23 prettyprinted" style=""> <ol class="linenums"> <li value="23" class="L2"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> endDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="kwd"> null    </span> <span class="pun"> ;    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now we can click on the  draggable (blue) rect, and when we move the mouse, it will slide right.  Clicking the static rect and dragging the mouse has no effect.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeSlideable(evt)"> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" class="background"> </rect> <rect class="draggable" x="7.499999999999988" y="5" width="8" height="10" fill="#007bff" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <rect class="static" x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> </svg> </section> </div> </div> <h2> Dragging an element    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now let's try to actually move the rect with the mouse. We can get the position of the mouse using     <b> evt.clientX    </b> and     <b> evt.clientY    </b> , and use these to update the coordinates of the element.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:15 prettyprinted" style=""> <ol class="linenums"> <li value="15" class="L4"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> preventDefault    </span> <span class="pun"> ();    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> dragX     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientX    </span> <span class="pun"> ;    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> dragY     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientY    </span> <span class="pun"> ;    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ,    </span> <span class="pln"> dragX    </span> <span class="pun"> );    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "y"    </span> <span class="pun"> ,    </span> <span class="pln"> dragY    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now if you click and drag the rect, you'll find that it... disappears, or goes somewhere unexpected.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable2(evt)"> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" class="background"> </rect> <rect class="draggable" x="847" y="261" width="8" height="10" fill="#007bff" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <rect class="static" x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> </svg> </section> </div> </div> <section class="section-block block-paragraph"> <div class="rich-text"> <h3> Fixing the coordinates    </h3> <p> The problem is that     <b> clientX    </b> and     <b> clientY    </b> give the mouse coordinates using the screen coordinate system (which  will be something like 300 x 200 pixels, though it depends on how you're viewing the page, since the images are responsive). We need to know the coordinates in SVG space, which is defined by the     <b> viewBox    </b> attribute, in this case 30 x 20.    </p> <p> To find out how to convert from the screen coordinate system to the SVG coordinate system, we can use the     <b> getScreenCTM    </b> method of the svg element. This returns the     <b> C    </b> urrent     <b> T    </b> ransformation     <b> M    </b> atrix for the screen, which is an object with six keys, a, b, c, d, e, f.    </p> <p> It's not too important what these values represent; in most cases all we need to know is that if an element has attributes of     <span class="MathJax_Preview" style="color: inherit; --darkreader-inline-color: inherit; display: none;" data-darkreader-inline-color=""> </span> <span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"> <nobr aria-hidden="true"> <span class="math" id="MathJax-Span-1" style="width: 2.047em; display: inline-block;"> <span style="display: inline-block; position: relative; width: 2.299em; height: 0px; font-size: 87%;"> <span style="position: absolute; clip: rect(1.421em, 1002.2em, 2.804em, -1000em); top: -2.363em; left: 0em;"> <span class="mrow" id="MathJax-Span-2"> <span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;"> (    </span> <span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math; font-style: italic;"> x    </span> <span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main;"> ,    </span> <span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;"> y    <span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"> </span> </span> <span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;"> )    </span> </span> <span style="display: inline-block; width: 0px; height: 2.363em;"> </span> </span> </span> <span style="display: inline-block; overflow: hidden; vertical-align: -0.273em; border-left: 0px solid; width: 0px; height: 0.981em; --darkreader-inline-border-left: currentcolor;" data-darkreader-inline-border-left=""> </span> </span> </nobr> <span class="MJX_Assistive_MathML" role="presentation"> <math xmlns="http://www.w3.org/1998/Math/MathML"> <mo stretchy="false"> (    </mo> <mi> x    </mi> <mo> ,    </mo> <mi> y    </mi> <mo stretchy="false"> )    </mo> </math> </span> </span> <script type="math/tex" id="MathJax-Element-1"> (x, y)    </script> , then it will have coordinates on screen of     <span class="MathJax_Preview" style="color: inherit; --darkreader-inline-color: inherit; display: none;" data-darkreader-inline-color=""> </span> <span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"> <nobr aria-hidden="true"> <span class="math" id="MathJax-Span-8" style="width: 5.942em; display: inline-block;"> <span style="display: inline-block; position: relative; width: 6.833em; height: 0px; font-size: 87%;"> <span style="position: absolute; clip: rect(1.421em, 1006.74em, 2.804em, -1000em); top: -2.363em; left: 0em;"> <span class="mrow" id="MathJax-Span-9"> <span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;"> (    </span> <span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math; font-style: italic;"> a    </span> <span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;"> x    </span> <span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.222em;"> +    </span> <span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;"> e    </span> <span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;"> ,    </span> <span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;"> d    <span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"> </span> </span> <span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math; font-style: italic;"> y    <span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"> </span> </span> <span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.222em;"> +    </span> <span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;"> f    <span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"> </span> </span> <span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;"> )    </span> </span> <span style="display: inline-block; width: 0px; height: 2.363em;"> </span> </span> </span> <span style="display: inline-block; overflow: hidden; vertical-align: -0.273em; border-left: 0px solid; width: 0px; height: 0.981em; --darkreader-inline-border-left: currentcolor;" data-darkreader-inline-border-left=""> </span> </span> </nobr> <span class="MJX_Assistive_MathML" role="presentation"> <math xmlns="http://www.w3.org/1998/Math/MathML"> <mo stretchy="false"> (    </mo> <mi> a    </mi> <mi> x    </mi> <mo> +    </mo> <mi> e    </mi> <mo> ,    </mo> <mi> d    </mi> <mi> y    </mi> <mo> +    </mo> <mi> f    </mi> <mo stretchy="false"> )    </mo> </math> </span> </span> <script type="math/tex" id="MathJax-Element-2"> (ax + e, dy + f)    </script> . So to find the position of the mouse in SVG space, we just calculate the inverse. So let's add a function to do that:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:9 prettyprinted" style=""> <ol class="linenums"> <li value="9" class="L8"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> CTM     </span> <span class="pun"> =    </span> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> getScreenCTM    </span> <span class="pun"> ();    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> return    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> x    </span> <span class="pun"> :    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientX     </span> <span class="pun"> -    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> e    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> /    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> a    </span> <span class="pun"> ,    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> y    </span> <span class="pun"> :    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientY     </span> <span class="pun"> -    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> f    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> /    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> d    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> };    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Then the drag function becomes:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:17 prettyprinted" style=""> <ol class="linenums"> <li value="17" class="L6"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> preventDefault    </span> <span class="pun"> ();    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> coord     </span> <span class="pun"> =    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> );    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ,    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> x    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "y"    </span> <span class="pun"> ,    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> y    </span> <span class="pun"> );    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now when you drag, the rect element moves with your mouse.    </p> <p> Unfortunately, it positions the corner of the rect where your mouse is, even if you select the center of the rect.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable3(evt)"> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" class="background"> </rect> <rect class="draggable" x="6.20550865964456" y="3.4630374725884896" width="8" height="10" fill="#007bff" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <rect class="static" x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> </svg> </section> </div> </div> <section class="section-block block-paragraph"> <div class="rich-text"> <h3> Fixing dragging    </h3> <p> There  are a couple of ways we could fix the dragging issue. I think the  easiest is to calculate the offset from where the mouse is first clicked at the top left of the rect. Then, when we set the coordinates of the  rect, we can subtract that value.    </p> <p> So calculate the offset in the     <b> startDrag    </b> function:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:16 prettyprinted" style=""> <ol class="linenums"> <li value="16" class="L5"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> selectedElement    </span> <span class="pun"> ,    </span> <span class="pln"> offset    </span> <span class="pun"> ;    </span> </code> </li> <li class="L6"> <code class="language-javascript"> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> startDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> .    </span> <span class="pln"> classList    </span> <span class="pun"> .    </span> <span class="pln"> contains    </span> <span class="pun"> (    </span> <span class="str"> 'draggable'    </span> <span class="pun"> ))    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> ;    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> offset     </span> <span class="pun"> =    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -=    </span> <span class="pln"> parseFloat    </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> getAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ));    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -=    </span> <span class="pln"> parseFloat    </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> getAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "y"    </span> <span class="pun"> ));    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> And then remove the offset in the     <b> drag    </b> function.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:27 prettyprinted" style=""> <ol class="linenums"> <li value="27" class="L6"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> preventDefault    </span> <span class="pun"> ();    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> coord     </span> <span class="pun"> =    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> );    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "x"    </span> <span class="pun"> ,    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> x    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> setAttributeNS    </span> <span class="pun"> (    </span> <span class="kwd"> null    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="str"> "y"    </span> <span class="pun"> ,    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> y    </span> <span class="pun"> );    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now everything should work perfectly.    </p> <p> Until...    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable4(evt)"> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" class="background"> </rect> <rect class="draggable" x="5.194723317501056" y="5.796482211667372" width="8" height="10" fill="#007bff" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <rect class="static" x="18" y="5" width="8" height="10" fill="#888" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> </svg> </section> </div> </div> <h2> Dragging other elements    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> As we've written it, the     <b> drag    </b> function works by updating the     <b> x    </b> and     <b> y    </b> attributes of the selected element. Unfortunately, most elements don't have     <b> x    </b> and     <b> y    </b> attributes. In order to make the function universal, we need to use transforms.    </p> <p> Working with transforms is a little tricky. I did write     <a href="https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_regex.svg"> a version that uses regex    </a> to parse the transform attribute for elements, which is a bit hacky,  but might be easier to understand. It also might not work if the target  element has some convoluted set of transformations already applied.    </p> <p> The version here is better, but might not work on all browsers. The idea is to calculate the offset from the first transform on the element, which  should be a translate transform. If the first transform is not a  translation, or the element doesn't have a transform, then we add one.    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:16 prettyprinted" style=""> <ol class="linenums"> <li value="16" class="L5"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> selectedElement    </span> <span class="pun"> ,    </span> <span class="pln"> offset    </span> <span class="pun"> ,    </span> <span class="pln"> transform    </span> <span class="pun"> ;    </span> </code> </li> <li class="L6"> <code class="language-javascript"> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> startDrag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> .    </span> <span class="pln"> classList    </span> <span class="pun"> .    </span> <span class="pln"> contains    </span> <span class="pun"> (    </span> <span class="str"> 'draggable'    </span> <span class="pun"> ))    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> ;    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> offset     </span> <span class="pun"> =    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> </span> <span class="com"> // Get all the transforms currently on this element    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> transforms     </span> <span class="pun"> =    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> baseVal    </span> <span class="pun"> ;    </span> </code> </li> <li class="L4"> <code class="language-javascript"> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> </span> <span class="com"> // Ensure the first transform is a translate transform    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> transforms    </span> <span class="pun"> .    </span> <span class="pln"> length     </span> <span class="pun"> ===    </span> <span class="pln"> </span> <span class="lit"> 0    </span> <span class="pln"> </span> <span class="pun"> ||    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> transforms    </span> <span class="pun"> .    </span> <span class="pln"> getItem    </span> <span class="pun"> (    </span> <span class="lit"> 0    </span> <span class="pun"> ).    </span> <span class="pln"> type     </span> <span class="pun"> !==    </span> <span class="pln"> </span> <span class="typ"> SVGTransform    </span> <span class="pun"> .    </span> <span class="pln"> SVG_TRANSFORM_TRANSLATE    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> </span> <span class="com"> // Create an transform that translates by (0, 0)    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> translate     </span> <span class="pun"> =    </span> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> createSVGTransform    </span> <span class="pun"> ();    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> translate    </span> <span class="pun"> .    </span> <span class="pln"> setTranslate    </span> <span class="pun"> (    </span> <span class="lit"> 0    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="lit"> 0    </span> <span class="pun"> );    </span> </code> </li> <li class="L1"> <code class="language-javascript"> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> </span> <span class="com"> // Add the translation to the front of the transforms list    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> baseVal    </span> <span class="pun"> .    </span> <span class="pln"> insertItemBefore    </span> <span class="pun"> (    </span> <span class="pln"> translate    </span> <span class="pun"> ,    </span> <span class="pln"> </span> <span class="lit"> 0    </span> <span class="pun"> );    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L5"> <code class="language-javascript"> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> </span> <span class="com"> // Get initial translation amount    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> transform     </span> <span class="pun"> =    </span> <span class="pln"> transforms    </span> <span class="pun"> .    </span> <span class="pln"> getItem    </span> <span class="pun"> (    </span> <span class="lit"> 0    </span> <span class="pun"> );    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -=    </span> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> matrix    </span> <span class="pun"> .    </span> <span class="pln"> e    </span> <span class="pun"> ;    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -=    </span> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> matrix    </span> <span class="pun"> .    </span> <span class="pln"> f    </span> <span class="pun"> ;    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> The drag function then updates the translation transform to the mouse position minus the offset:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:42 prettyprinted" style=""> <ol class="linenums"> <li value="42" class="L1"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> drag    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> selectedElement    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> preventDefault    </span> <span class="pun"> ();    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> coord     </span> <span class="pun"> =    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> );    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> setTranslate    </span> <span class="pun"> (    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> x    </span> <span class="pun"> ,    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> y    </span> <span class="pun"> );    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Now we have a     <b> makeDraggable    </b> function that should work on any element regardless of its type and the transformations applied to it.    </p> <p> The order of the elements stays the same, so the ellipse will always be in  front of the rect elements, but behind the others. I'll write a separate tutorial on how to move elements up and down in the z-axis.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable(evt)"> <rect class="background" x="0" y="0" width="30" height="20"> </rect> <rect class="static" fill="#888" x="2" y="4" width="6" height="2" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> <rect class="draggable" fill="#007bff" x="2" y="4" width="6" height="2" transform="translate(3.28549, -0.199121) rotate(90, 5, 5) translate(10)" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <ellipse class="draggable" fill="#ff00af" cx="5" cy="5" rx="3" ry="2" transform="translate(8.5066, 2.09077)" style="--darkreader-inline-fill: #cc008c;" data-darkreader-inline-fill=""> </ellipse> <polygon class="draggable" fill="#ffa500" transform="translate(2.68813, -1.99121) rotate(15, 15, 15)" points="16.9 15.6 17.4 18.2 15 17 12.6 18.2 13.1 15.6 11.2 13.8 13.8 13.4 15 11 16.2 13.4 18.8 13.8" style="--darkreader-inline-fill: #cc8400;" data-darkreader-inline-fill=""> </polygon> <path class="draggable" stroke="#2bad7b" stroke-width="0.5" fill="none" d="M1 5C5 1 5 9 9 5" transform="translate(18.9048, 1.39384)" style="--darkreader-inline-stroke: #5dd7a8;" data-darkreader-inline-stroke=""> </path> <text class="draggable" x="25" y="15" text-anchor="middle" font-size="3px" alignment-baseline="middle"> Drag    </text> </svg> </section> </div> </div> <h2> Working on mobile    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> On final thing: getting mouse  events to work on mobile and touch devices. The first thing we need to  do is to add handlers for the touch events:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:7 prettyprinted" style=""> <ol class="linenums"> <li value="7" class="L6"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'touchstart'    </span> <span class="pun"> ,    </span> <span class="pln"> startDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'touchmove'    </span> <span class="pun"> ,    </span> <span class="pln"> drag    </span> <span class="pun"> );    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'touchend'    </span> <span class="pun"> ,    </span> <span class="pln"> endDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'touchleave'    </span> <span class="pun"> ,    </span> <span class="pln"> endDrag    </span> <span class="pun"> );    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> addEventListener    </span> <span class="pun"> (    </span> <span class="str"> 'touchcancel'    </span> <span class="pun"> ,    </span> <span class="pln"> endDrag    </span> <span class="pun"> );    </span> </code> </li> </ol> </pre> </section> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Then, because there can be multiple touches, we need to use only the position of the first one. So we have to update the     <b> getMousePosition    </b> function:    </p> </div> </section> <section class="section-block block-code_block"> <pre class="prettyprint linenums:14 prettyprinted" style=""> <ol class="linenums"> <li value="14" class="L3"> <code class="language-javascript"> <span class="kwd"> function    </span> <span class="pln"> getMousePosition    </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> var    </span> <span class="pln"> CTM     </span> <span class="pun"> =    </span> <span class="pln"> svg    </span> <span class="pun"> .    </span> <span class="pln"> getScreenCTM    </span> <span class="pun"> ();    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> touches    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> <span class="pln"> evt     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> touches    </span> <span class="pun"> [    </span> <span class="lit"> 0    </span> <span class="pun"> ];    </span> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> return    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> x    </span> <span class="pun"> :    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientX     </span> <span class="pun"> -    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> e    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> /    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> a    </span> <span class="pun"> ,    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> y    </span> <span class="pun"> :    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> clientY     </span> <span class="pun"> -    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> f    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> /    </span> <span class="pln"> CTM    </span> <span class="pun"> .    </span> <span class="pln"> d    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> </span> <span class="pun"> };    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </section> <h2> Working with groups    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> There are still a few elements this code won't work with: groups and foreignObjects. The reason is  that these elements wrap child elements.    </p> </div> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> In the case of foreignObjects  you can add a style to prevent the child element from responding to  mouse events. Otherwise the code will attempt to add transform  attributes to them, which won't work.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <pre class="prettyprint linenums prettyprinted" style=""> <ol class="linenums"> <li class="L0"> <code class="language-CSS"> <span class="pln"> foreignObject     </span> <span class="pun"> *    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L1"> <code class="language-CSS"> <span class="pln"> pointer    </span> <span class="pun"> -    </span> <span class="pln"> events    </span> <span class="pun"> :    </span> <span class="pln"> none    </span> <span class="pun"> ;    </span> </code> </li> <li class="L2"> <code class="language-CSS"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </div> </div> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> With groups, the groups themselves to do not capture mouse events, so we need to get the group element from the child element.    </p> </div> </section> <pre class="prettyprint linenums prettyprinted" style=""> <ol class="linenums"> <li class="L0"> <code class="language-javascript"> <span class="pln"> selectedElement     </span> <span class="pun"> =    </span> <span class="pln"> evt    </span> <span class="pun"> .    </span> <span class="pln"> target    </span> <span class="pun"> .    </span> <span class="pln"> parentNode    </span> <span class="pun"> ;    </span> </code> </li> </ol> </pre> <section class="section-block block-paragraph"> <div class="rich-text"> <p> You can find the full code     <a href="https://github.com/petercollingridge/code-for-blog/blob/master/svg-interaction/draggable/draggable_groups.svg"> here    </a> , which allows for dragging both individual elements and groups (e.g. the star and ellipse).    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable(evt)"> /* STYLE */    <style class="darkreader darkreader--sync" media="screen"> </style> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" fill="#eee" style="--darkreader-inline-fill: #222426;" data-darkreader-inline-fill=""> </rect> <rect class="static" fill="#888" x="2" y="4" width="6" height="2" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> <rect class="draggable" fill="#007bff" x="2" y="4" width="6" height="2" transform="rotate(90, 5, 5) translate(10, 0)" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <g class="draggable-group"> <ellipse fill="#ff00af" cx="5" cy="5" rx="3" ry="2" transform="translate(10, 0)" style="--darkreader-inline-fill: #cc008c;" data-darkreader-inline-fill=""> </ellipse> <polygon fill="#ffa500" transform="rotate(15, 15, 15)" points="16.9 15.6 17.4 18.2 15 17 12.6 18.2 13.1 15.6 11.2 13.8 13.8 13.4 15 11 16.2 13.4 18.8 13.8" style="--darkreader-inline-fill: #cc8400;" data-darkreader-inline-fill=""> </polygon> </g> <g class="draggable-group"> <path stroke="#2bad7b" stroke-width="0.5" fill="none" d="M1 5C5 1 5 9 9 5" transform="translate(20)" style="--darkreader-inline-stroke: #5dd7a8;" data-darkreader-inline-stroke=""> </path> <text x="25" y="15" text-anchor="middle" font-size="3px" alignment-baseline="middle"> Drag    </text> </g> </svg> </section> </div> </div> <h2> Constraining movement    </h2> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Several people have asked how  to restrict the movement of items when dragging. At the very least it  would make sense to prevent items from being dragged off screen.    </p> </div> </section> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> The first thing we need to do  is to define the boundary we're going to restrict items' movement to.  Here I'm using four variables to define a rectangular boundary. If you  want to use a more complex shape then you'll have to look into more  complex collision detection.    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <pre class="prettyprint linenums:31 prettyprinted" style=""> <ol class="linenums"> <li value="31" class="L0"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> boundaryX1     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="lit"> 10.5    </span> <span class="pun"> ;    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> boundaryX2     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="lit"> 30    </span> <span class="pun"> ;    </span> </code> </li> <li class="L2"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> boundaryY1     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="lit"> 2.2    </span> <span class="pun"> ;    </span> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> boundaryY2     </span> <span class="pun"> =    </span> <span class="pln"> </span> <span class="lit"> 19.2    </span> <span class="pun"> ;    </span> </code> </li> </ol> </pre> </div> </div> <section class="section-block block-paragraph"> <div class="rich-text"> <p> In the     <b> startDrag    </b> function, we test whether the selected element has the class "confine".  This is only required if you want some items to be unconstrained.    </p> </div> </section> <div class="row"> <div class="col-md-5 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Then we use the built-in     <b> getBBox    </b> method to find the bounding box of the element. This returns an object with attributes,     <b> x    </b> ,     <b> y    </b> ,     <b> width    </b> and     <b> height    </b> for a box that surrounds the item. We can use this to find the bounding coordinates for the element relative to the boundary.    </p> </div> </section> </div> <div class="col-md-7 two-col-block right-block"> <pre class="prettyprint linenums:65 prettyprinted" style=""> <ol class="linenums"> <li value="65" class="L4"> <code class="language-javascript"> <span class="pln"> confined     </span> <span class="pun"> =    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> classList    </span> <span class="pun"> .    </span> <span class="pln"> contains    </span> <span class="pun"> (    </span> <span class="str"> 'confine'    </span> <span class="pun"> );    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> confined    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> bbox     </span> <span class="pun"> =    </span> <span class="pln"> selectedElement    </span> <span class="pun"> .    </span> <span class="pln"> getBBox    </span> <span class="pun"> ();    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> minX     </span> <span class="pun"> =    </span> <span class="pln"> boundaryX1     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> x    </span> <span class="pun"> ;    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pln"> maxX     </span> <span class="pun"> =    </span> <span class="pln"> boundaryX2     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> width    </span> <span class="pun"> ;    </span> </code> </li> <li class="L9"> <code class="language-javascript"> <span class="pln"> minY     </span> <span class="pun"> =    </span> <span class="pln"> boundaryY1     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> y    </span> <span class="pun"> ;    </span> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> maxY     </span> <span class="pun"> =    </span> <span class="pln"> boundaryY2     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -    </span> <span class="pln"> bbox    </span> <span class="pun"> .    </span> <span class="pln"> height    </span> <span class="pun"> ;    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> </ol> </pre> </div> </div> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Note that     <b> getBBox    </b> doesn't take into account transformations on the element, so it's best  to not have elements with existing transformations. You can either     <a href="https://petercollingridge.appspot.com/svg-transforms"> apply the transformations    </a> to the element directly or wrap everything in a group.    </p> </div> </section> <div class="row"> <div class="col-md-5 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Then, in the     <b> drag    </b> method, we calculate the position the element is dragged to, and ensure it doesn't exceed the boundary before applying it    </p> </div> </section> </div> <div class="col-md-7 two-col-block right-block"> <pre class="prettyprint linenums:81 prettyprinted" style=""> <ol class="linenums"> <li value="81" class="L0"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> dx     </span> <span class="pun"> =    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> x     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> x    </span> <span class="pun"> ;    </span> </code> </li> <li class="L1"> <code class="language-javascript"> <span class="kwd"> var    </span> <span class="pln"> dy     </span> <span class="pun"> =    </span> <span class="pln"> coord    </span> <span class="pun"> .    </span> <span class="pln"> y     </span> <span class="pun"> -    </span> <span class="pln"> offset    </span> <span class="pun"> .    </span> <span class="pln"> y    </span> <span class="pun"> ;    </span> </code> </li> <li class="L2"> <code class="language-javascript"> </code> </li> <li class="L3"> <code class="language-javascript"> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> confined    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> </code> </li> <li class="L4"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> dx     </span> <span class="pun"> &lt;    </span> <span class="pln"> minX    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> <span class="pln"> dx     </span> <span class="pun"> =    </span> <span class="pln"> minX    </span> <span class="pun"> ;    </span> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L5"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> else    </span> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> dx     </span> <span class="pun"> &gt;    </span> <span class="pln"> maxX    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> <span class="pln"> dx     </span> <span class="pun"> =    </span> <span class="pln"> maxX    </span> <span class="pun"> ;    </span> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L6"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> dy     </span> <span class="pun"> &lt;    </span> <span class="pln"> minY    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> <span class="pln"> dy     </span> <span class="pun"> =    </span> <span class="pln"> minY    </span> <span class="pun"> ;    </span> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L7"> <code class="language-javascript"> <span class="pln"> </span> <span class="kwd"> else    </span> <span class="pln"> </span> <span class="kwd"> if    </span> <span class="pln"> </span> <span class="pun"> (    </span> <span class="pln"> dy     </span> <span class="pun"> &gt;    </span> <span class="pln"> maxY    </span> <span class="pun"> )    </span> <span class="pln"> </span> <span class="pun"> {    </span> <span class="pln"> dy     </span> <span class="pun"> =    </span> <span class="pln"> maxY    </span> <span class="pun"> ;    </span> <span class="pln"> </span> <span class="pun"> }    </span> </code> </li> <li class="L8"> <code class="language-javascript"> <span class="pun"> }    </span> </code> </li> <li class="L9"> <code class="language-javascript"> </code> </li> <li class="L0"> <code class="language-javascript"> <span class="pln"> transform    </span> <span class="pun"> .    </span> <span class="pln"> setTranslate    </span> <span class="pun"> (    </span> <span class="pln"> dx    </span> <span class="pun"> ,    </span> <span class="pln"> dy    </span> <span class="pun"> );    </span> </code> </li> </ol> </pre> </div> </div> <div class="row"> <div class="col-md-7 two-col-block left-block"> <section class="section-block block-paragraph"> <div class="rich-text"> <p> Here's an example of the code  in action. The dark grey box represents the restricted area. The ellipse star and word all have the "confine" class name so they cannot leave  the box. The rectangle and squiggle don't have the class name, so can  move freely.    </p> <p> The complete code can be found     <a href="https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_restricted.svg"> here    </a> .    </p> </div> </section> </div> <div class="col-md-5 two-col-block right-block"> <section class="section-block block-html"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 20" onload="makeDraggable(evt)"> /* STYLE */    <style class="darkreader darkreader--sync" media="screen"> </style> /* SCRIPT */    <rect x="0" y="0" width="30" height="20" fill="#eee" style="--darkreader-inline-fill: #222426;" data-darkreader-inline-fill=""> </rect> <rect x="10.5" y="2.2" width="19.5" height="17" fill="#bbb" style="--darkreader-inline-fill: #3e4446;" data-darkreader-inline-fill=""> </rect> <rect class="static" fill="#888" x="2" y="4" width="6" height="2" style="--darkreader-inline-fill: #5b6367;" data-darkreader-inline-fill=""> </rect> <rect class="draggable" fill="#007bff" x="4" y="11" width="2" height="6" style="--darkreader-inline-fill: #0062cc;" data-darkreader-inline-fill=""> </rect> <ellipse class="draggable confine" fill="#ff00af" cx="5" cy="5" rx="3" ry="2" transform="translate(10, 0)" style="--darkreader-inline-fill: #cc008c;" data-darkreader-inline-fill=""> </ellipse> <polygon class="draggable confine" fill="#ffa500" points="16.9 15.6 17.4 18.2 15 17 12.6 18.2 13.1 15.6 11.2 13.8 13.8 13.4 15 11 16.2 13.4 18.8 13.8" style="--darkreader-inline-fill: #cc8400;" data-darkreader-inline-fill="" transform="translate(0.796482, -0.0995603)"> </polygon> <path class="draggable" stroke="#2bad7b" stroke-width="0.5" fill="none" d="M1 5C5 1 5 9 9 5" transform="translate(20)" style="--darkreader-inline-stroke: #5dd7a8;" data-darkreader-inline-stroke=""> </path> <text class="draggable confine" x="25" y="15" text-anchor="middle" font-size="3px" alignment-baseline="middle"> Drag    </text> </svg> </section> </div> </div> </article> <div> <div id="comments-wrapper"> <h2> Comments (66)    </h2> <div id="comments-None" data-object-id="None" class="comments "> <div id="c160" class="comment-item"> <h4> Michael Everitt    <span class="comment-date"> on 23 Feb 2012, 5:22 p.m.    </span> </h4> <div class="comment-text"> <p> It must be challenging to step back and write a description for beginners.      </p> <p> Your write-up for dragging svg shapes is just about perfect for me.    </p> <p> The step-by step breakdown makes the parts digestible, the attention  to formatting and naming contributes a lot to understandability, the  isolated example given at the end helps to firm up a holistic view, and  the way you touch on topics that could be hugely distracting, such as  the transformation matrix usage, with just enough information to lead to success, is really admirable.    </p> <p> Thank you for a great description.    </p> </div> </div> <div id="c161" class="comment-item"> <h4> Peter    <span class="comment-date"> on 23 Feb 2012, 11:42 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks for your kind words  Michael, I appreciate you taking the time to write. It's very  encouraging to hear that this has been of use and makes me want get on  with writing a full SVG tutorial. I'm not that far beyond a beginner, so it's not much of a step to write something I think I would have found  useful.    </p> <p> All the best, Peter    </p> </div> </div> <div id="c162" class="comment-item"> <h4> zass    <span class="comment-date"> on 11 Apr 2012, 9:44 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks for this great post!  Any way to get this to work with a group &lt;g&gt; of elements? I have  more complex shapes made through &lt;g&gt; that I want to move together  as a unit.    </p> </div> </div> <div id="c163" class="comment-item"> <h4> Peter    <span class="comment-date"> on 11 Apr 2012, 10:05 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks. I've answered a  similar question on StackOverflow  (http://stackoverflow.com/questions/7777010/svg-dragging-for-group/7778990#7778990). If you look at the code for the example you should be able to work it  out. The only real difference is to select the parent element when you  click on a shape. One day I'll get around to writing an proper tutorial  here.    </p> </div> </div> <div id="c164" class="comment-item"> <h4> mO    <span class="comment-date"> on 20 Jun 2012, 4:05 p.m.    </span> </h4> <div class="comment-text"> <p> I'd like to second Michael Everitt's sentiments precisely.  Thanks-a-bunch for this well delivered info.    </p> <p> One question .. what would I need to tweak to allow the selected shape to only be able to move along the x OR y axis.    </p> <p> Well ... I'm really most interested in the X axis ... I include the Y axis out of sheer curiosity :)    </p> </div> </div> <div id="c165" class="comment-item"> <h4> mO    <span class="comment-date"> on 20 Jun 2012, 4:37 p.m.    </span> </h4> <div class="comment-text"> <p> Nevermind about X or Y axis only movement. I found a simple solution.    </p> <p> Changed "currentMatrix[5] += dy"  to  "currentMatrix[5] = dy" (+= to  =). Seems to work nicely ...  let me know if there are reasons to do it  differently :)    </p> <p> Next question though, is about dragging &lt;def&gt;'d shapes.  It  seems to only work if I explicitly call out a &lt;rect&gt; ...  the  dragging doesn't seem to work on shapes drawn via &lt;use&gt; ...   thoughts?    </p> </div> </div> <div id="c166" class="comment-item"> <h4> Nuno Goncalves    <span class="comment-date"> on 28 Mar 2013, 2:02 p.m.    </span> </h4> <div class="comment-text"> <p> Your attachement drag_elements.svg have a small bug.    </p> <p> function deselectElement(evt) {    <br/> if(selectedElement != 0){    <br/> selectedElement = 0;    <br/> selectedElement.removeAttributeNS(null, "onmousemove");    <br/> selectedElement.removeAttributeNS(null, "onmouseout");    <br/> selectedElement.removeAttributeNS(null, "onmouseup");    <br/> }    <br/> }    </p> <p> Note that you are clearing selectedElement before using it to remove the handlers.    </p> </div> </div> <div id="c167" class="comment-item"> <h4> Peter    <span class="comment-date"> on 15 Apr 2013, 12:16 a.m.    </span> </h4> <div class="comment-text"> <p> Thanks for pointing out the  mistake Nuno. I must have forgotten to update the code. I've updated it  now and it should work properly.    </p> </div> </div> <div id="c168" class="comment-item"> <h4> Aslam    <span class="comment-date"> on 4 Jul 2013, 9:49 p.m.    </span> </h4> <div class="comment-text"> <p> Very very thanks to you.. I  dont know how to say thanks to you.. Because I was looking for svg code  with moving elements. I saw many site with moving elements in svg. But  those were working with me. But this code is working well with me..     </p> <p> But if we drag fastly,, it causes mose control ... why..      </p> <p> by Aslam.Pk    </p> </div> </div> <div id="c169" class="comment-item"> <h4> Phil    <span class="comment-date"> on 22 Oct 2013, 8:22 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks for the excellent  introduction!  I had one issue: the script stops responding if you move  the mouse fast enough to get the cursor outside the bounds of the  element before the code in moveElement finishes executing.      </p> <p> I was able to resolve this problem by simply replacing the line:    </p> <p> selectedElement.setAttributeNS(null, "onmousemove", "moveElement(evt)");    </p> <p> with:    </p> <p> document.onmousemove = moveElement;    </p> <p> and replacing the line:    </p> <p> selectedElement.removeAttributeNS(null, "onmousemove");    </p> <p> with:    </p> <p> document.onmousemove = null;    </p> <p> This way the script pays attention to all mouse move events in the  document, even if the mouse isn't over the element for brief periods as  things are moving around.    </p> <p> I found this solution here.    </p> </div> </div> <div id="c170" class="comment-item"> <h4> Michael Albert    <span class="comment-date"> on 15 Dec 2013, 10:41 p.m.    </span> </h4> <div class="comment-text"> <p> Thank you very much for  producing such an extremely useful document!There are two small issues  which I wonder if you've thought about. 1) If, while dragging and  continuing to hold down the button on the mouse, the cursor leaves the  window even briefly and then re-enters, the object is no longer being  dragged. I used to do a little programming under the X-Windows system,  and it had two features (i) while the mouse button was held down, events were delivered to the original window and (ii) one could determine the  state of the mouse buttons in the context of a mouse movement event.  It seems HTML5/javascript/SVG doesn't work that way.2) In Firefox 25.0.1,  about a quarter of the time, instead of dragging the object as expected, I find myself dragging a translucent copy of one or both squares.  It  is as though some other "drag-and-drop" mechnism is competing with the  one you have implemented.   Have you noticed this? Again, thank you and  best wishes, Mike Albert    </p> </div> </div> <div id="c171" class="comment-item"> <h4> Dave    <span class="comment-date"> on 16 Feb 2014, 6:52 a.m.    </span> </h4> <div class="comment-text"> <p> I noticed the same thing as  Michael Albert.  Working on trial and error to attack.  I'm going to  look into what Phil said too...sounds possibly germane.  Else, what a  great doc, it wraps up a number of points in a  succinct useful form.   Like the writer above mentions, I am trying to ignore Y, and also to  limit the range of dragging.    </p> </div> </div> <div id="c172" class="comment-item"> <h4> Anonymous    <span class="comment-date"> on 18 Feb 2014, 12:29 p.m.    </span> </h4> <div class="comment-text"> <p> Unfortunately there is a  glaring flaw in this. this works because you have created an SVG 400x200 with a viewbox also 400x200,  a pixel as returned by clientX etc is the same size as a pixel in the transformation matrix. However if you took  advantage of the S in SVG and had a view box of different dimensions  e.g. 4000x2000 or 40x20 (or worse still a different aspect ratio) the  shape would not move with the mouse.    </p> <p> See http://www.codedread.com/blog/archives/2005/12/21/how-to-enable-dragging... for a way of overcoming this.    </p> </div> </div> <div id="c173" class="comment-item"> <h4> Remi    <span class="comment-date"> on 22 Nov 2014, 8:39 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks for your tutorial but it doesn't work on IOS.    </p> <p> Is it possible to do the same thing with a finger and not a mouse ?    </p> <p> ...sorry for my english    </p> </div> </div> <div id="c174" class="comment-item"> <h4> Hans Erik Hazelhorst    <span class="comment-date"> on 10 Jul 2015, 5:33 p.m.    </span> </h4> <div class="comment-text"> <p> Thank you for this extremely  useful introduction. I have an additional question: how can I pass the  result of a drag operation to a URL?    </p> <p> My SVG objects (and all Javascript ) are rendered by a database  program, and I need to pass information back to the program using a URL  with some parameters. How do I get the resulting coordinates back into  parameters in the URL?    </p> </div> </div> <div id="c175" class="comment-item"> <h4> Hans Erik Hazelhorst    <span class="comment-date"> on 10 Jul 2015, 8:52 p.m.    </span> </h4> <div class="comment-text"> <p> Thank you for the excellent  introduction on making interactive SVGs. Perhaps you tell me how I can  retrieve the position of the svg object after the dragging operation,  and return it as a part of a URL?    </p> </div> </div> <div id="c176" class="comment-item"> <h4> Karl_Heg    <span class="comment-date"> on 21 Feb 2016, 10:43 p.m.    </span> </h4> <div class="comment-text"> <p> The draggable solution in svg or html is a good solution to make    <br/> classifications per position X/Y    <br/> example:    <br/> Horizontal: Fruits/left:600px; Vegetables/800px; Cereales/1000px    </p> <p> Vertical: Poatatoes;Rice;Banana;Mais; Apple;Toatoes;Chicoree    </p> <p> all vertical values: left:400px    </p> <p> set the vertical objects to the right horizontal object/group etc    </p> <p> Is it a possibility to save the changed values/result-document?    </p> <p> Best Regards    </p> <p> Karl_Heg    </p> </div> </div> <div id="c177" class="comment-item"> <h4> Alex    <span class="comment-date"> on 17 Mar 2016, 8:52 p.m.    </span> </h4> <div class="comment-text"> <p> Thanks a lot. I needed to  animate movement of an svg element and had trouble using jquery or css.  Your solution using matrix worked for me.    </p> </div> </div> <div id="c178" class="comment-item"> <h4> Rustem Zakiev    <span class="comment-date"> on 11 Oct 2016, 5:22 p.m.    </span> </h4> <div class="comment-text"> <p> Very helpful! Thank you!    </p> </div> </div> <div id="c179" class="comment-item"> <h4> Anonymous    <span class="comment-date"> on 11 Jan 2017, 7:28 a.m.    </span> </h4> <div class="comment-text"> <p> Thanks Heaps Peter, great work.    </p> <p> I'm utilising the drag drop and tooltip.    </p> <p> Given some slightly obscure requirements, I've found your work very helpfull in piecing together what I need for my scenario.    </p> <p> Your a champ, thanks again.    </p> </div> </div> <div id="c180" class="comment-item"> <h4> Jonathan    <span class="comment-date"> on 15 Jun 2017, 2:43 a.m.    </span> </h4> <div class="comment-text"> <p> Well let me say that even after all these years, you just helped a student for his work of end of studies. :)     <br/> So thank you very much    </p> </div> </div> <div id="c181" class="comment-item"> <h4> Shashank    <span class="comment-date"> on 15 Jun 2017, 7 a.m.    </span> </h4> <div class="comment-text"> <p> Hi peter,    </p> <p> Can you please also post a tutorial on "How to do a free transfrom of
												objects/images in SVG similar to Photoshop Free Transform feature"? I  could not find any relevent info on this.    </p> <p> Thanks in advance    </p> <p> Shashank    </p> </div> </div> <div id="c182" class="comment-item"> <h4> Jaroslav    <span class="comment-date"> on 2 Dec 2017, 1:03 a.m.    </span> </h4> <div class="comment-text"> <p> Hi!     </p> <p> I tried your code with rect elements and with image element. See:  http://vysoky.pythonanywhere.com/files/brython/dragndrop-svg-for-peter.html    </p> <p> In google chrome it works fine but in firefox image element's  behavior is different. There is some strange firefox self dragging.  Sometimes a rectangle starts to behave in the same way. I must select  the second rectangle to stop the behavior. I tried it with FF v. 57.0.1  in Linux Mint.     </p> <p> Do you have any idea for correct behavior in firefox too?     </p> <p> Thanks!     </p> <p> Jaroslav    </p> </div> </div> <div id="c183" class="comment-item"> <h4> Percival    <span class="comment-date"> on 3 Dec 2017, 7:35 p.m.    </span> </h4> <div class="comment-text"> <p> So ... if I have this set up, so I can build a map, from elements, how do I share that built map with someone else?  In other words, how do I save all the transforms that  have taken place and then hand that map to someone else, who might want  to move things around further, and then hand something back to me?    </p> <p> Thank you.    </p> </div> </div> <div id="c927" class="comment-item"> <h4> Henrik    <span class="comment-date"> on 13 Jun 2018, 11:02 a.m.    </span> </h4> <div class="comment-text"> <p> Thanks Peter, this was just what I needed!    <br/> Starting from a basic example and building upon that until you got a working  solution, and explaining each step it the way to go.    </p> </div> </div> <div id="c976" class="comment-item"> <h4> Abdul Mateen    <span class="comment-date"> on 20 Jun 2018, 4:13 p.m.    </span> </h4> <div class="comment-text"> <p> Hi,    </p> <p> First of all, thank you for making this tutorial. I've followed the same steps as you've mentioned but I'm facing an issue.    </p> <p> Reproducing steps:    <br/> --------------------------    <br/> First time drag  the rectangle box somewhere, then try to drag it again or just click it, see it starts from x=0 y=0 coordinates because of the 'offset' value  and the 'coord' values are same so, coord.x - offset.x results in 0    </p> <p> Could you please help me fix this issue you can find the fiddle here http://jsfiddle.net/spamrvt1/    </p> <p> Thanks in advance    </p> </div> </div> <div id="c978" class="comment-item"> <h4> Peter    <span class="comment-date"> on 20 Jun 2018, 10:24 p.m.    </span> </h4> <div class="comment-text"> <p> Hi Abdul,    </p> <p> Thanks for giving such a well documented bug report. It seems I forgot to show the updated drag function. It should be:    </p> <p> function drag(evt) {    <br/> if (selectedElement) {    <br/> var coord = getMousePosition(evt);    <br/> transform.setTranslate(coord.x - offset.x, coord.y - offset.y);    <br/> }    <br/> }    </p> <p> The full code can be found here:    <br/> https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_final.svg    </p> </div> </div> <div id="c980" class="comment-item"> <h4> Abdul Mateen    <span class="comment-date"> on 21 Jun 2018, 7:05 a.m.    </span> </h4> <div class="comment-text"> <p> Hi Peter,    </p> <p> Thanks for such a quick response, it works now :)    </p> </div> </div> <div id="c990" class="comment-item"> <h4> Henrik    <span class="comment-date"> on 22 Jun 2018, 11:13 a.m.    </span> </h4> <div class="comment-text"> <p> Hmm, the full code example  https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_final.svg, does not contains the multiple touchsupport you included last in your  article.     <br/> if (evt.touches) {     <br/> evt = evt.touches[0];     <br/> }    </p> <p> There is also an extra quote-character last on this line:    <br/> &lt;rect x="4" y="5" width="8" height="10" fill="#007bff""/&gt;
												<br/>
												Under "SVG Setup"
											</p>
										</div>
									</div>
									<div id="c994" class="comment-item">
										<h4>
											Peter
											<span class="comment-date">
												on 22 Jun 2018, 10:21 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												The code including touch support is at:
												<br/>
												https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_mobile.svg
												<br/>
												Calling the other file draggable_final.svg is a bit misleading, I'll rename it.
											</p>
											<p>
												I've removed the extra double quote. Thanks for the feedback.
											</p>
										</div>
									</div>
									<div id="c1122" class="comment-item">
										<h4>
											Jim
											<span class="comment-date">
												on 3 Sep 2018, 1:49 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												how does this work with SVG
												that is loaded from a file?  So in this example, the SVG is defined in
												the HTML document.  I want to be able to load an SVG element from a
												file, and then scale, rotate and translate it across a specified area.  I
												have tried adapting this code, but it hasn't worked so far.  I think
												maybe I need a new approach?
											</p>
										</div>
									</div>
									<div id="c1123" class="comment-item">
										<h4>
											Peter
											<span class="comment-date">
												on 4 Sep 2018, 2:05 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I don't quite understand your
												set-up. Is the SVG an external file, which you're adding into the HTML
												using an &lt;object&gt;, &lt;iframe&gt; or &lt;embed&gt;? The code you
												be basically the same, but you might need to make a few changes depend
												on where the JS code is. I've cover the different ways to use JS and SVG
												here:
												http://www.petercollingridge.co.uk/tutorials/svg/interactive/javascript/
												but let me know if it's not clear.
											</p>
										</div>
									</div>
									<div id="c1129" class="comment-item">
										<h4>
											Christoph
											<span class="comment-date">
												on 7 Sep 2018, 11:37 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Thank you very much for this
												fantastic post. I particular like the step-by-step approach, which
												really sets the basis for a good understanding. For me this has been the
												best post on this subject, which I was able to find so far.
											</p>
										</div>
									</div>
									<div id="c1130" class="comment-item">
										<h4>
											Donnie
											<span class="comment-date">
												on 9 Sep 2018, 2:54 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Have you successfully dragged a foreignObject?  I keep getting NaN errors related to offset.
											</p>
										</div>
									</div>
									<div id="c1132" class="comment-item">
										<h4>
											Peter
											<span class="comment-date">
												on 10 Sep 2018, 10:14 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hi Donnie, I added an example
												of dragging a foreignObject here:
												https://raw.githubusercontent.com/petercollingridge/code-for-blog/master/svg-interaction/draggable/draggable_foreign.svg
											</p>
											<p>
												I added the draggable class to the foreign object element and then
												added a style foreignObject * { pointer-events: none; } so the mouse
												events ignored any of the other elements inside the foreignObject. I
												don't think you can transform them directly as non SVG elements won't
												have transform attributes.
											</p>
										</div>
									</div>
									<div id="c1179" class="comment-item">
										<h4>
											Maja
											<span class="comment-date">
												on 7 Nov 2018, 1:31 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I also just wanted to say
												thank you for this really useful tutorial. It saved me a lot of time
												having all of this on a silver platter.
											</p>
										</div>
									</div>
									<div id="c1250" class="comment-item">
										<h4>
											Scott
											<span class="comment-date">
												on 9 Jan 2019, 10:01 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Very clear presentation.  Thanks for writing this!
											</p>
										</div>
									</div>
									<div id="c1253" class="comment-item">
										<h4>
											binchem
											<span class="comment-date">
												on 12 Jan 2019, 12:45 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												add "transform: scale(0.5);" to SVG element, in Safari not work well. how can i fix it?
											</p>
										</div>
									</div>
									<div id="c1310" class="comment-item">
										<h4>
											Billybobtimjim
											<span class="comment-date">
												on 14 Feb 2019, 5:11 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I tried to do it on a svg sprite sheet and it didn't work.
											</p>
										</div>
									</div>
									<div id="c1317" class="comment-item">
										<h4>
											Vip
											<span class="comment-date">
												on 22 Feb 2019, 1:26 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Excellent tutorial. This was
												exactly what I was looking for. Thanks for making such evergreen
												content, so clearly written, and with great pedagogic design.
											</p>
											<p>
												I've found that everything worked perfectly until I got to
												foreignObjects (no issue at all with your code for dragging, but one
												with scaling of fixed-size foreignObjects—the paragraph text was
												huge—that has a StackOverflow answer here:
												https://stackoverflow.com/questions/45043777/how-to-avoid-scaling-of-elements-inside-foreignobjects-of-svgs/45044646.
												I've improved the code that was there, if you want to include it/link
												to it: https://github.com/vipatron/fixed-size-foreignObject.js )
											</p>
											<p>
												Also, one small error I noticed in the last file to which you linked
												via gitHub: You call getMousePosition, but have removed it from the
												makeDraggable function. (The code works perfectly when it is
												re-inserted).
											</p>
										</div>
									</div>
									<div id="c1322" class="comment-item">
										<h4>
											Andrew
											<span class="comment-date">
												on 25 Feb 2019, 9:53 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hi there, this is awesome thank you. really simple clear and easy to follow.
											</p>
											<p>
												Do you know how one object could be restricted to move in a sub
												region of the view Box. E.g. a smaller box to move the object within,
												inside the main box.
											</p>
											<p>
												Thanks Andrew.
											</p>
										</div>
									</div>
									<div id="c1331" class="comment-item">
										<h4>
											Christoff
											<span class="comment-date">
												on 3 Mar 2019, 5:47 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Fantastic tutorial thank you!
											</p>
											<p>
												I just want to know, is it in any way possible to restrict the
												draggable blocks so that they cannot exit the viewbox or to restrict
												them within the bounds of a div/container? Also, is there a way to
												"freeze"/disable the movement of the blocks when they reach a specific
												set of coordinates?
											</p>
											<p>
												Thanks
											</p>
										</div>
									</div>
									<div id="c1476" class="comment-item">
										<h4>
											George
											<span class="comment-date">
												on 11 Apr 2019, 3:06 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												First off thanks for a great
												tutorial. Seems like the complete code is not available in git at the
												link mentioned above (it is just a list of .svg files). I think it is
												probably in one the other directories so will look around. If not I can
												probably piece it together from the blog post but would be nice if there
												was a minimal downloadable working example..
											</p>
										</div>
									</div>
									<div id="c1477" class="comment-item">
										<h4>
											George
											<span class="comment-date">
												on 11 Apr 2019, 3:11 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I think I found it here in git: code-for-blog/svg-interaction/pan_and_zoom_mouse/test.html
											</p>
										</div>
									</div>
									<div id="c1482" class="comment-item">
										<h4>
											Peter
											<span class="comment-date">
												on 12 Apr 2019, 10:14 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hi George, the code is in the SVG files. The SVGs contain a script element which contains everything.
											</p>
										</div>
									</div>
									<div id="c1515" class="comment-item">
										<h4>
											John Geddes
											<span class="comment-date">
												on 30 Apr 2019, 7:36 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Excellent stuff - thank you
												so much for sharing this. Everything was going so well with an
												interactive svg trial using your approach - until I tried using Edge on
												Windows 10 (version 44.17763.1.0, which is shown as current version at
												the date of writing).
											</p>
											<p>
												As the code is written, dragging doesn't work properly on Edge, throwing these errors:
											</p>
											<p>
												SCRIPT5022: IndexSizeError
												<br/>
												SCRIPT5007: Unable to get property 'setTranslate' of undefined or null reference
											</p>
											<p>
												BUT I did notice that the ellipse was OK. What was special about the
												ellipse? A quick check identified that this was the only svg element
												with a transform hard-coded into its original definition.
											</p>
											<p>
												A bit of experimentation confirms that Edge is happy if every svg
												element that doesn't need a different transform nevertheless has
												transform='translate(0, 0)' added into its hard coding: there is
												something Edge doesn't like about the Javascript that adds such a
												transform automatically. There may be a more elegant solution, but this
												rescued me!
											</p>
										</div>
									</div>
									<div id="c1643" class="comment-item">
										<h4>
											Davy
											<span class="comment-date">
												on 15 Jul 2019, 10 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hi @John Geddes,
											</p>
											<p>
												I had a similar issue with Edge, fixed it with the following:
												<br/>
												transforms.numberOfItems === 0
											</p>
											<p>
												here:
											</p>
											<p>
												if (transforms.length === 0 || transforms.numberOfItems === 0 ||
												transforms.getItem(0).type !== SVGTransform.SVG_TRANSFORM_TRANSLATE) {
											</p>
											<p>
												Hope this helps.
											</p>
										</div>
									</div>
									<div id="c1704" class="comment-item">
										<h4>
											Peter2
											<span class="comment-date">
												on 13 Sep 2019, 1:10 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I checked the Z-ordering infos on the web.
												<br/>
												Tried &lt;use xlink:href=myid&gt;, but lose the event handlers. Any lead?
											</p>
										</div>
									</div>
									<div id="c1706" class="comment-item">
										<h4>
											James S.
											<span class="comment-date">
												on 14 Sep 2019, 2:49 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												I'm trying to decide whether
												or not to use the Pointer Lock API.  It solves the issue of other
												elements getting mouse events during the drag operation, among other
												things.  But it also seems to break touch compatibility and thus I must
												keep my existing code in some form in order to support touch dragging.
												<br/>
												Any thoughts or insights on this, 7 years later?
											</p>
										</div>
									</div>
									<div id="c1746" class="comment-item">
										<h4>
											Jiahuan
											<span class="comment-date">
												on 16 Oct 2019, 5:59 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hi there, I'm hitting an issue that onload does not seem to be supported by svg element.
											</p>
										</div>
									</div>
									<div id="c1794" class="comment-item">
										<h4>
											Adam
											<span class="comment-date">
												on 16 Nov 2019, 7:24 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Still very useful, thanks for the tutorial!!
											</p>
										</div>
									</div>
									<div id="c1816" class="comment-item">
										<h4>
											Givanildo Silva de Amorim
											<span class="comment-date">
												on 6 Dec 2019, 11:29 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Hello Mr Peter. Very cool
												tutorial! Thank you so much for the teachings! I would like to ask you
												for some guidance on the tooltip. How can I get the tooltip to work on
												mobile. I implemented the tooltip code from your tutorial in my svg and
												it worked normally, but dynamically created svg elements don't work. It
												is possible to give guidance on this. Thank you very much. Greetings
												from Brazil. Givanildo S. Amorim
											</p>
										</div>
									</div>
									<div id="c1835" class="comment-item">
										<h4>
											Different Adam
											<span class="comment-date">
												on 29 Dec 2019, 4:48 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Fantastic tutorial. Up until
												recently I only thought of SVG as that thing that icons and logos were
												designed in, but then I started looking into how stuff like draw.io are
												made and it turns out it was SVG. Mind blown. I'm now all in on taking
												SVG to its limits using React.
											</p>
											<p>
												I'm curious of your thoughts on SVG vs WebGL. I looked into it some
												and it seems that WebGL is clearly more powerful but also SVGElement
												being a subclass of HTMLElement brings a lot to the table.
											</p>
										</div>
									</div>
									<div id="c1914" class="comment-item">
										<h4>
											Marco Antonio
											<span class="comment-date">
												on 13 Feb 2020, 6:49 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Thank you very much!! &lt;3
											</p>
										</div>
									</div>
									<div id="c1915" class="comment-item">
										<h4>
											Bart
											<span class="comment-date">
												on 14 Feb 2020, 7:27 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												One of the best-written tutorial I've ever seen. Thanks man, really appreciate it
											</p>
										</div>
									</div>
									<div id="c1970" class="comment-item">
										<h4>
											Rodgers
											<span class="comment-date">
												on 13 Mar 2020, 12:29 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Thanks very much for this excellent turoriel.
												<br/>
												Can we do like the "sortable" function of jquery.
												<br/>
												Cdlt,
												<br/>
												Rodgers
											</p>
										</div>
									</div>
									<div id="c1996" class="comment-item">
										<h4>
											AST
											<span class="comment-date">
												on 26 Mar 2020, 9:34 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Your tutorial was perfect for the work I needed done. Thanks so much!
											</p>
										</div>
									</div>
									<div id="c2068" class="comment-item">
										<h4>
											Bill W.
											<span class="comment-date">
												on 18 Apr 2020, 3:34 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Outstanding work! Thank you very much for such a detailed explanation and example.
											</p>
										</div>
									</div>
									<div id="c2139" class="comment-item">
										<h4>
											Joaquim
											<span class="comment-date">
												on 13 May 2020, 7:20 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Can you give an example of droppable elements like a chessboard?
											</p>
										</div>
									</div>
									<div id="c2171" class="comment-item">
										<h4>
											Bing Liu
											<span class="comment-date">
												on 2 Jun 2020, 3:21 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Outstanding work! Thank you for sharing such a well-explained article.
											</p>
										</div>
									</div>
									<div id="c2173" class="comment-item">
										<h4>
											Artem Eastwood
											<span class="comment-date">
												on 6 Jun 2020, 10:08 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												You are the best! It helped me a lot, thank you :)
											</p>
										</div>
									</div>
									<div id="c2188" class="comment-item">
										<h4>
											Nali
											<span class="comment-date">
												on 19 Jun 2020, 12:43 a.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												So far the best article about dragging in SVG that I read from 2015 ! Great Job
											</p>
										</div>
									</div>
									<div id="c2200" class="comment-item">
										<h4>
											karim abdel karim
											<span class="comment-date">
												on 26 Jun 2020, 6:49 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												i cant do this step "Fixing the coordinates" im getting this error
											</p>
											<p>
												Uncaught ReferenceError: svg is not defined
												<br/>
												at getMousePosition (WebForm2.aspx:47)
												<br/>
												at SVGSVGElement.drag (WebForm2.aspx:36)
											</p>
										</div>
									</div>
									<div id="c2236" class="comment-item">
										<h4>
											Danny Engelman
											<span class="comment-date">
												on 21 Jul 2020, 2:52 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												@Joaquim,
												<br/>
												&gt; Can you give an example of droppable elements like a chessboard?
												<br/>
												There are SVG ChessPieces as Custom Elements on an interactive board at: https://chessmeister.github.io/
											</p>
										</div>
									</div>
									<div id="c2402" class="comment-item">
										<h4>
											Colin
											<span class="comment-date">
												on 19 Oct 2020, 8:57 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												First off, this is excellent
												and exactly what I needed to get started with my 'learning' project. I'm
												creating a map where I can move objects around. The only piece I'm
												trying to add is a way to make the icons stick to every 10th pixel on
												both x and y when the user does a 'mouseup' to ensure that things remain
												lined up properly (otherwise there is a line of objects all off by 2 or
												3 pixels and it drives me nuts). I've messed around a little with your
												code to try and make it work but with no success yet, any tips you can
												provide to even point me in the right direction would be appreciated!
											</p>
										</div>
									</div>
									<div id="c2443" class="comment-item">
										<h4>
											Bjorn D
											<span class="comment-date">
												on 9 Nov 2020, 10:40 p.m.
											</span>
										</h4>
										<div class="comment-text">
											<p>
												Pretty much an echo of the
												other comments here, but: Thanks a lot for this tutorial, it is
												extremely helpful! I'm currently making an SVG application using vue.js
												and most of the interaction is based on the techniques you have shown
												here. I'm planning to put out some codepens or similar with vue.js/SVG
												interaction. Vue.js and SVG is a really good match!
											</p>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-4">
								<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/tooltip/">
									<span class="naviagation-arrow">
										<i class="fa fa-caret-left" aria-hidden="true">
										</i>
									</span>
									<span class="navigation-name">
										Tooltip
									</span>
								</a>
							</div>
							<div class="col-4 parent-page-link">
								<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/">
									Interactive SVGs
								</a>
							</div>
							<div class="col-4 next-page-link">
								<a href="https://www.petercollingridge.co.uk/tutorials/svg/interactive/pan-and-zoom/">
									<span class="navigation-name">
										Panning and zooming
									</span>
									<span class="naviagation-arrow">
										<i class="fa fa-caret-right" aria-hidden="true">
										</i>
									</span>
								</a>
							</div>
						</div>
					</div>
				</main>
				<div class="footer">
				</div>
			</div>
			<!-- Bootstrap core JavaScript -->
			<script type="text/javascript">
						function makeSlideable(evt) {
							var svg = evt.target;
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
			
							var selectedElement = null;
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
									var x = parseFloat(selectedElement.getAttributeNS(null, "x"));
									selectedElement.setAttributeNS(null, "x", x + 0.1);
								}
							}
			
							function endDrag(evt) {
								selectedElement = null;
							}
						}
					</script>
			<script type="text/javascript">
						function makeDraggable2(evt) {
							var svg = evt.target;
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
			
							var selectedElement = null;
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
									var dragX = evt.clientX;
									var dragY = evt.clientY;
									selectedElement.setAttributeNS(null, "x", dragX);
									selectedElement.setAttributeNS(null, "y", dragY);
								}
							}
			
							function endDrag(evt) {
								selectedElement = null;
							}
						}
					 </script>
			<script type="text/javascript">
						function makeDraggable3(evt) {
							var svg = evt.target;
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
			
							var selectedElement = null;
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
									var CTM = svg.getScreenCTM();
									var dragX = (evt.clientX - CTM.e) / CTM.a;
									var dragY = (evt.clientY - CTM.f) / CTM.d;
									selectedElement.setAttributeNS(null, "x", dragX);
									selectedElement.setAttributeNS(null, "y", dragY);
								}
							}
			
							function endDrag(evt) {
								selectedElement = null;
							}
						}
					 </script>
			<script type="text/javascript">
						function makeDraggable4(evt) {
							var svg = evt.target;
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
			
							function getMousePosition(evt) {
								var CTM = svg.getScreenCTM();
								return {
									x: (evt.clientX - CTM.e) / CTM.a,
									y: (evt.clientY - CTM.f) / CTM.d
								};
							}
			
							var selectedElement, offset;
			
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
									offset = getMousePosition(evt);
									offset.x -= parseFloat(selectedElement.getAttributeNS(null, "x"));
									offset.y -= parseFloat(selectedElement.getAttributeNS(null, "y"));
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
									var coord = getMousePosition(evt);
									selectedElement.setAttributeNS(null, "x", coord.x - offset.x);
									selectedElement.setAttributeNS(null, "y", coord.y - offset.y);
								}
							}
			
							function endDrag(evt) {
								selectedElement = null;
							}
						}
					 </script>
			<script type="text/javascript">
						function makeDraggable(evt) {
							var svg = evt.target;
			
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
							svg.addEventListener('touchstart', startDrag);
							svg.addEventListener('touchmove', drag);
							svg.addEventListener('touchend', endDrag);
							svg.addEventListener('touchleave', endDrag);
							svg.addEventListener('touchcancel', endDrag);
			
							function getMousePosition(evt) {
								var CTM = svg.getScreenCTM();
								if (evt.touches) { evt = evt.touches[0]; }
								return {
									x: (evt.clientX - CTM.e) / CTM.a,
									y: (evt.clientY - CTM.f) / CTM.d
								};
							}
			
							var selectedElement, offset, transform;
			
							function initialiseDragging(evt) {
									offset = getMousePosition(evt);
			
									// Make sure the first transform on the element is a translate transform
									var transforms = selectedElement.transform.baseVal;
			
									if (transforms.length === 0 || transforms.getItem(0).type !== SVGTransform.SVG_TRANSFORM_TRANSLATE) {
										// Create an transform that translates by (0, 0)
										var translate = svg.createSVGTransform();
										translate.setTranslate(0, 0);
										selectedElement.transform.baseVal.insertItemBefore(translate, 0);
									}
			
									// Get initial translation
									transform = transforms.getItem(0);
									offset.x -= transform.matrix.e;
									offset.y -= transform.matrix.f;
							}
			
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
									initialiseDragging(evt);
								} else if (evt.target.parentNode.classList.contains('draggable-group')) {
									selectedElement = evt.target.parentNode;
									initialiseDragging(evt);
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
									var coord = getMousePosition(evt);
									transform.setTranslate(coord.x - offset.x, coord.y - offset.y);
								}
							}
			
							function endDrag(evt) {
								selectedElement = false;
							}
						}
					 </script>
			<script type="text/javascript">
						function makeDraggable(evt) {
							var svg = evt.target;
			
							svg.addEventListener('mousedown', startDrag);
							svg.addEventListener('mousemove', drag);
							svg.addEventListener('mouseup', endDrag);
							svg.addEventListener('mouseleave', endDrag);
							svg.addEventListener('touchstart', startDrag);
							svg.addEventListener('touchmove', drag);
							svg.addEventListener('touchend', endDrag);
							svg.addEventListener('touchleave', endDrag);
							svg.addEventListener('touchcancel', endDrag);
			
							var selectedElement, offset, transform,
									bbox, minX, maxX, minY, maxY, confined;
			
							var boundaryX1 = 10.5;
							var boundaryX2 = 30;
							var boundaryY1 = 2.2;
							var boundaryY2 = 19.2;
			
							function getMousePosition(evt) {
								var CTM = svg.getScreenCTM();
								if (evt.touches) { evt = evt.touches[0]; }
								return {
									x: (evt.clientX - CTM.e) / CTM.a,
									y: (evt.clientY - CTM.f) / CTM.d
								};
							}
			
							function startDrag(evt) {
								if (evt.target.classList.contains('draggable')) {
									selectedElement = evt.target;
									offset = getMousePosition(evt);
			
									// Make sure the first transform on the element is a translate transform
									var transforms = selectedElement.transform.baseVal;
			
									if (transforms.length === 0 || transforms.getItem(0).type !== SVGTransform.SVG_TRANSFORM_TRANSLATE) {
										// Create an transform that translates by (0, 0)
										var translate = svg.createSVGTransform();
										translate.setTranslate(0, 0);
										selectedElement.transform.baseVal.insertItemBefore(translate, 0);
									}
			
									// Get initial translation
									transform = transforms.getItem(0);
									offset.x -= transform.matrix.e;
									offset.y -= transform.matrix.f;
			
									confined = evt.target.classList.contains('confine');
									if (confined) {
											bbox = selectedElement.getBBox();
											minX = boundaryX1 - bbox.x;
											maxX = boundaryX2 - bbox.x - bbox.width;
											minY = boundaryY1 - bbox.y;
											maxY = boundaryY2 - bbox.y - bbox.height;
									}
								}
							}
			
							function drag(evt) {
								if (selectedElement) {
									evt.preventDefault();
			
									var coord = getMousePosition(evt);
									var dx = coord.x - offset.x;
									var dy = coord.y - offset.y;
			
									if (confined) {
											if (dx &lt; minX) { dx = minX; }
											else if (dx &gt; maxX) { dx = maxX; }
											if (dy &lt; minY) { dy = minY; }
											else if (dy &gt; maxY) { dy = maxY; }
									}
			
									transform.setTranslate(dx, dy);
								}
							}
			
							function endDrag(evt) {
								selectedElement = false;
							}
						}
					 </script>
			<script src="Draggable%20SVG%20elements_files/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
			<script src="Draggable%20SVG%20elements_files/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
			<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px; --darkreader-inline-border-top: currentcolor; --darkreader-inline-border-right: currentcolor; --darkreader-inline-border-bottom: currentcolor; --darkreader-inline-border-left: currentcolor;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
				<div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size4, sans-serif; --darkreader-inline-border-top: currentcolor; --darkreader-inline-border-right: currentcolor; --darkreader-inline-border-bottom: currentcolor; --darkreader-inline-border-left: currentcolor;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
				</div>
			</div>
		</body>
	</html>
